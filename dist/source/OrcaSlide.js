"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_Utils=require("./Utils"),_Utils2=_interopRequireDefault(_Utils);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var OrcaSlide=function(){function a(b){_classCallCheck(this,a),this.configSlide=b,this.autoPlayTimer=null,this.initSlider()}var b=Math.ceil;return _createClass(a,[{key:"animateSlide",value:function(){var a=this,b=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],c=this.configSlide,d=c.active,e=c.contentItem,f=c.itemWidth,g=c.items,h=c.moveTo,i=c.time,j=c.position,k=c.isInfinite,l=b?h:-h,m=b?j+1:j-1,n=g<m||0>m;if(d)if(this.callbacks(b,m),k&&n)this.isInfinite=m;else if(!n){this.configSlide.position+=b?1:-1,this.configSlide.active=!1,this.isInfinite=m;var o=0,p=setInterval(function(){if(_Utils2.default.moveToScroll(l,e),o+=h,o>=f){clearInterval(p);var b=f*a.configSlide.position;_Utils2.default.moveToScroll(b,e,!1),a.configSlide.active=!0}},i)}}},{key:"autoPlay",value:function a(){var b=this,c=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.configSlide.autoPlay=c;var d=this.configSlide,a=d.autoPlay,e=d.timeAutoPlay;c||a?c&&a&&(this.autoPlayTimer=setInterval(function(){b.animateSlide()},e)):clearInterval(this.autoPlayTimer)}},{key:"callbacks",value:function a(b,c){var a=this.configSlide.callbacks,d=b?c-1:c+1,e=a["Slide"+d]||null;if(e){var f=e.next===b||e.previus&&!b;try{f&&e.callback()}catch(a){console.groupCollapsed("%c \uD83D\uDEAB [OrcaSlide => Error]","color:#FFF;"),console.error(a),console.groupEnd("[OrcaSlide => Error]")}}}},{key:"displayArrow",value:function(a){var b=this.configSlide,c=b.autoPlay,d=b.arrowNext,e=b.arrowPrevious,f=b.items,g=b.isInfinite,h=0<a?"":"none",i=f===a?"none":"";_Utils2.default.displayToggle(d,i),_Utils2.default.displayToggle(e,h),c&&!g&&"none"===i&&this.autoPlay(!1)}},{key:"initSlider",value:function(){return this.validateConfig.setActionButton.resizeSlide.startTouch(),this.configSlide.autoPlay&&this.autoPlay(),0}},{key:"startTouch",value:function(){var a=this,b=_Utils2.default.isMobile,c=this.configSlide,d=c.contentItem,e=c.items;if("desktop"!==b){var f=0;d.addEventListener("touchstart",function(a){var b=a.changedTouches[0];f=parseInt(b.clientX,10),a.preventDefault()},!1),d.addEventListener("touchmove",function(b){var c=b.changedTouches[0],d="",g=parseInt(c.clientX,10);d=0<g-f?"right":"left","left"===d&&a.configSlide.position<e?(a.autoPlay(!1),a.animateSlide(!0)):"right"===d&&0<a.configSlide.position&&(a.autoPlay(!1),a.animateSlide(!1)),b.preventDefault()},!1)}}},{key:"isInfinite",set:function(a){var b=this.configSlide,c=b.contentItem,d=b.isInfinite,e=b.items,f=b.itemWidth,g=(0>a||a>e)&&a;if(d){if(0>a||a>e){c.style.scrollBehavior="smooth";var h=0>g?e*f:0;_Utils2.default.moveToScroll(h,c,!1),this.configSlide.position=0>g?e:0,this.configSlide.active=!0,c.removeAttribute("style")}}else this.displayArrow(a)}},{key:"resizeSlide",get:function(){var a=this,c=this.configSlide,d=_Utils2.default.existFields(c,"item",null),e=_Utils2.default.existFields(c,"content",null);return null!==d&&null!==e&&window.addEventListener("resize",function(){a.configSlide.scrollWidth=e.scrollWidth,a.configSlide.moveTo=b(d.offsetWidth/256),a.configSlide.itemWidth=d.offsetWidth;var f=d.offsetWidth*a.configSlide.position;_Utils2.default.moveToScroll(f,c.contentItem,!1)}),this}},{key:"setActionButton",get:function(){var a=this;return["arrowNext","arrowPrevious","ctrlStop","ctrlPlay"].forEach(function(b){var c=a.configSlide[b],d=function(){};b.includes("ctrl")?(d=function(){a.autoPlay("ctrlPlay"===b)},_Utils2.default.actionButton(c,d)):(d=function(){a.animateSlide("arrowNext"===b),a.autoPlay(!1)},_Utils2.default.actionButton(c,d))}),this}},{key:"validateConfig",get:function(){var a=this,c=this.configSlide,d=c.callbacks,e=c.jump;return["arrowNext","arrowPrevious","contentItem"].forEach(function(c){var d=a.configSlide[c],f=_Utils2.default.getElementDom(d),g="desktop"===_Utils2.default.isMobile?128:e;if(f&&(a.configSlide[c]=f,"contentItem"===c)){var h=f.children[0]||{},i=h.offsetWidth||0,j={items:f.children.length-1,itemWidth:i,moveTo:b(i/g),scrollWidth:f.scrollWidth||0,time:1e3*a.configSlide.time/512,item:h,content:f};a.configSlide.active=0<j.items&&0<j.moveTo,Object.assign(a.configSlide,j),a.configSlide.isInfinite||_Utils2.default.displayToggle(a.configSlide.arrowPrevious,"none")}}),this.configSlide.callbacks=_Utils2.default.getCallbacksConfig(d),this.validateConfigAutoPlay}},{key:"validateConfigAutoPlay",get:function(){var a=this.configSlide,b=a.active,c=a.ctrlPlay,d=a.ctrlStop,e=a.timeAutoPlay;if(b){var f={timeAutoPlay:1e3*e,ctrlPlay:_Utils2.default.getElementDom(c),ctrlStop:_Utils2.default.getElementDom(d)};Object.assign(this.configSlide,f)}return this}}]),a}();exports.default=OrcaSlide;